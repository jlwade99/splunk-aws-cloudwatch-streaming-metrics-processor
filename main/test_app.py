import unittest
from main import app


class Test(unittest.TestCase):
	def test_lambda_handler(self):
		self.event = {
			"invocationId": "214e762e-a57f-48c7-9251-337e60f10dfd",
			"deliveryStreamArn": "arn:aws:firehose:us-east-1:134183635603:deliverystream/firehose-to-splunk",
			"region": "us-west-2",
			"records": [
				{
					"recordId": "49610520579565593542493647173350442178010946319379595266000000",
					"approximateArrivalTimestamp": 1601456607310,
					"data": "2QUK1gUKsgEKFwoOY2xvdWQucHJvdmlkZXISBQoDYXdzCiIKEGNsb3VkLmFjY291bnQuaWQSDgoMMTIzNDU2Nzg5MDEyChsKDGNsb3VkLnJlZ2lvbhILCgl1cy1lYXN0LTEKVgoQYXdzLmV4cG9ydGVyLmFybhJCCkBhcm46YXdzOmNsb3Vkd2F0Y2g6dXMtZWFzdC0xOjEyMzQ1Njc4OTAxMjptZXRyaWMtc3RyZWFtL015U3RyZWFtEp4EEvkCCjRhbWF6b25hd3MuY29tL0FXUy9EeW5hbW9EQi9Db25zdW1lZFJlYWRDYXBhY2l0eVVuaXRzGgd7Q291bnR9WrcCCpQBChkKCU5hbWVzcGFjZRIMQVdTL0R5bmFtb0RCCicKCk1ldHJpY05hbWUSGUNvbnN1bWVkUmVhZENhcGFjaXR5VW5pdHMKFAoJVGFibGVOYW1lEgdNeVRhYmxlEQBArywpjGMWGQCY9iQ3jGMWIWkAAAAAAAAAKQAAAAAA4GFAMgAyEgkAAAAAAADwPxEAAAAAAAA2QAqdAQoZCglOYW1lc3BhY2USDEFXUy9EeW5hbW9EQgonCgpNZXRyaWNOYW1lEhlDb25zdW1lZFJlYWRDYXBhY2l0eVVuaXRzChQKCVRhYmxlTmFtZRIHTXlUYWJsZREAmPYkN4xjFhkA8D0dRYxjFiFvAAAAAAAAACkAAAAAAOBiQDIJEQAAAAAAAAhAMhIJAAAAAAAA8D8RAAAAAAAAOUASnwEKIWFtYXpvbmF3cy5jb20vQVdTL0xhbWJkYS9EdXJhdGlvbhoCbXNadgp0ChcKCU5hbWVzcGFjZRIKQVdTL0xhbWJkYQoWCgpNZXRyaWNOYW1lEghEdXJhdGlvbhEAQK8sKYxjFhkAmPYkN4xjFiERAAAAAAAAACkAAAAAwDHmQDIJEaRwPQrXo+g/MhIJAAAAAAAA8D8RAAAAAEAZ5UA="
				},
				{
					"recordId": "49610520579565593542493647173350442178010946319379595266000000",
					"approximateArrivalTimestamp": 1601456607310,
					"data": "2QUK1gUKsgEKFwoOY2xvdWQucHJvdmlkZXISBQoDYXdzCiIKEGNsb3VkLmFjY291bnQuaWQSDgoMMTIzNDU2Nzg5MDEyChsKDGNsb3VkLnJlZ2lvbhILCgl1cy1lYXN0LTEKVgoQYXdzLmV4cG9ydGVyLmFybhJCCkBhcm46YXdzOmNsb3Vkd2F0Y2g6dXMtZWFzdC0xOjEyMzQ1Njc4OTAxMjptZXRyaWMtc3RyZWFtL015U3RyZWFtEp4EEvkCCjRhbWF6b25hd3MuY29tL0FXUy9EeW5hbW9EQi9Db25zdW1lZFJlYWRDYXBhY2l0eVVuaXRzGgd7Q291bnR9WrcCCpQBChkKCU5hbWVzcGFjZRIMQVdTL0R5bmFtb0RCCicKCk1ldHJpY05hbWUSGUNvbnN1bWVkUmVhZENhcGFjaXR5VW5pdHMKFAoJVGFibGVOYW1lEgdNeVRhYmxlEQBArywpjGMWGQCY9iQ3jGMWIWkAAAAAAAAAKQAAAAAA4GFAMgAyEgkAAAAAAADwPxEAAAAAAAA2QAqdAQoZCglOYW1lc3BhY2USDEFXUy9EeW5hbW9EQgonCgpNZXRyaWNOYW1lEhlDb25zdW1lZFJlYWRDYXBhY2l0eVVuaXRzChQKCVRhYmxlTmFtZRIHTXlUYWJsZREAmPYkN4xjFhkA8D0dRYxjFiFvAAAAAAAAACkAAAAAAOBiQDIJEQAAAAAAAAhAMhIJAAAAAAAA8D8RAAAAAAAAOUASnwEKIWFtYXpvbmF3cy5jb20vQVdTL0xhbWJkYS9EdXJhdGlvbhoCbXNadgp0ChcKCU5hbWVzcGFjZRIKQVdTL0xhbWJkYQoWCgpNZXRyaWNOYW1lEghEdXJhdGlvbhEAQK8sKYxjFhkAmPYkN4xjFiERAAAAAAAAACkAAAAAwDHmQDIJEaRwPQrXo+g/MhIJAAAAAAAA8D8RAAAAAEAZ5UA="
				}
			]
		}

		ret = app.lambda_handler(self.event, "")
		assert ret['records'][0]['result'] == "Ok"


if __name__ == '__main__':
	unittest.main()